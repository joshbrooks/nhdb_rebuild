// Generated by CoffeeScript 1.10.0
(function() {
  var appName, modelName;

  modelName = 'project';

  appName = 'projecttracker';

  window.ProjectStore = function(projects) {
    var self;
    riot.observable(this);
    self = this;
    self.projects = projects || [];
    self.edit = {};
    self.filters = '';

    /* Request the latest projects from DRF */
    self.on('projects_reload', function(opts) {
      var filters, page, per_page, request;
      opts = opts || {};
      page = opts.page || 1;
      per_page = opts.per_page || 100;
      filters = opts.filters || '';
      self.filters = filters;
      request = {
        'url': "/" + appName + "/api/" + modelName + "/?page_size=" + per_page + "&page=" + page + "&" + filters,
        'method': 'GET',
        'data': '',
        'status': 0,
        'done': 'projects_reload_done',
        'action': 'immediate',
        'fail': 'projects_reload_from_server_fail'
      };
      return RiotControl.trigger('request_add', request);
    });
    self.on('projects_reload_done', function(data, textStatus, jqXHR) {
      self.projects = data.results;
      return self.trigger('projects_changed', self.projects, data.page, data.count, data.page_size);
    });
    self.on('ping', function() {
      return alert('ping');
    });
    return self.on('tag_selected', function(e) {
      return console.log(e);
    });
  };

}).call(this);
